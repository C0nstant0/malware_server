#include <WinSock2.h>
#include <iostream>
#pragma comment (lib, "ws2_32.lib")

using namespace std;

int main()
{
	//winSock 라이브러리 초기화
	WSDATA data;
	::WSAStartup(MAKEWORD(2, 2), &data);

	// 소켓 생성 하는 부분
	SOCKET server = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
	if (server == INVALID_SOCKET)
		cout << "server fail" << endl;

	// 바인딩 하는 부분
	sockadd_in addr = { 0 };

	addr.sin_family = AF_INET;
	addr.sin_addr.s_addr = inet_addr("127.0.0.1");
	addr.sin_port = htons(8888);

	if (bind(server, (sockaddr*)&addr, sizeof(addr)) == SOCKET_ERROR)
		cout << "Bind Error" << endl;
	
	// 연결 대기하는 곳
	if (listen(server, SOMAXCONN) == SOCKET_ERROR)
		cout << "listen Error" << endl;

	// 연결 수락
	SOCKET client = accept(server, NULL, NULL);
	closesocket(client);

	// 소켓 종료
	closesocket(server);
	::WSACleanup();

}